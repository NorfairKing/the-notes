\tikzstyle{block}=[rectangle, fill=white, draw=black, minimum height=1em, minimum width=2em, fill opacity=1, text opacity=1]
\tikzstyle{fun}=[circle, draw=black]

\node (title) at (-0.25, 1) {$encap$};
\draw (-2.5, -0.5) rectangle (0.5, 2.5);

\node[block] (ak) at (0.5, 2) {$A$};
\node[block] (ac) at (0.5, 0) {$A$};
\coordinate (ai) at (-1, 2) {};
\node[fun] (enc) at (-1, 0) {$E$};
\node[block] (an) at (-2.5, 0) {$A$};

\node (p) at (-1.3, 1.5) {$p$};
\node (p) at (-1.7, 0.2) {$k$};
\node (p) at (-0.3, 0.2) {$c$};

\draw (ak) -- (ai);
\draw (ai) -- (enc);
\draw[arrows={-latex}] (ai) -- (enc);
\draw[arrows={-latex}] (enc) -- (ac);
\draw[arrows={-latex}] (enc) -- (an);


